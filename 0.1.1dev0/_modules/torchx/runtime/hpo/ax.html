


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torchx.runtime.hpo.ax &mdash; PyTorch/TorchX main documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/torchx.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/katex-math.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/torchx.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <!-- Google Analytics -->
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-117752657-2');
    </script>
  
  <!-- End Google Analytics -->
  

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
                  <span class="dropdown-title">torchaudio</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
                  <span class="dropdown-title">torchtext</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
                  <span class="dropdown-title">torchvision</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
                  <span class="dropdown-title">TorchElastic</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
                  <span class="dropdown-title">TorchServe</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
                  <span class="dropdown-title">PyTorch on XLA Devices</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about PyTorchâ€™s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/hub">
                  <span class="dropdown-title">Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            
    <div class="version">
      <a href='/torchx/versions.html'>v0.1.1dev0 &#x25BC</a>
    </div>
    


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../basics.html">Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../advanced.html">Advanced Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples_apps/index.html">Application Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples_pipelines/index.html">Pipelines Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/train.html">Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/distributed.html">Distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/interpret.html">Interpret</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/hpo.html">HPO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/serve.html">Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/utils.html">Utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Application (Runtime)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../runtime/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../runtime/hpo.html">HPO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../runtime/tracking.html">Tracking</a></li>
</ul>
<p class="caption"><span class="caption-text">Schedulers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../schedulers/local.html">Local</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../schedulers/kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../schedulers/slurm.html">Slurm</a></li>
</ul>
<p class="caption"><span class="caption-text">Pipelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../pipelines/kfp.html">Kubeflow Pipelines</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../specs.html">torchx.specs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../runner.html">torchx.runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../schedulers.html">torchx.schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pipelines.html">torchx.pipelines</a></li>
</ul>
<p class="caption"><span class="caption-text">Best Practices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../app_best_practices.html">App Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../component_best_practices.html">Component Best Practices</a></li>
</ul>
<p class="caption"><span class="caption-text">Experimental Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../experimental/runner.config.html">(beta) .torchxconfig file</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../../index.html">Module code</a> &gt;</li>
        
      <li>torchx.runtime.hpo.ax</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
  

  <!-- copied from pytorch_sphinx_theme -->
  
  <div class="rst-content">
  
    <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
     <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
      
  <h1>Source code for torchx.runtime.hpo.ax</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># Copyright (c) Facebook, Inc. and its affiliates.</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># This source code is licensed under the BSD-style license found in the</span>
<span class="c1"># LICENSE file in the root directory of this source tree.</span>

<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">cast</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">ax.core</span> <span class="kn">import</span> <span class="n">Trial</span>
<span class="kn">from</span> <span class="nn">ax.core.abstract_data</span> <span class="kn">import</span> <span class="n">AbstractDataFrameData</span>
<span class="kn">from</span> <span class="nn">ax.core.base_trial</span> <span class="kn">import</span> <span class="n">BaseTrial</span>
<span class="kn">from</span> <span class="nn">ax.core.data</span> <span class="kn">import</span> <span class="n">Data</span>
<span class="kn">from</span> <span class="nn">ax.core.metric</span> <span class="kn">import</span> <span class="n">Metric</span>
<span class="kn">from</span> <span class="nn">ax.core.runner</span> <span class="kn">import</span> <span class="n">Runner</span> <span class="k">as</span> <span class="n">ax_Runner</span>
<span class="kn">from</span> <span class="nn">ax.service.scheduler</span> <span class="kn">import</span> <span class="n">Scheduler</span> <span class="k">as</span> <span class="n">ax_Scheduler</span><span class="p">,</span> <span class="n">TrialStatus</span>
<span class="kn">from</span> <span class="nn">ax.utils.common.typeutils</span> <span class="kn">import</span> <span class="n">not_none</span>
<span class="kn">from</span> <span class="nn">pyre_extensions</span> <span class="kn">import</span> <span class="n">none_throws</span>
<span class="kn">from</span> <span class="nn">torchx.runner</span> <span class="kn">import</span> <span class="n">Runner</span><span class="p">,</span> <span class="n">get_runner</span>
<span class="kn">from</span> <span class="nn">torchx.runtime.tracking</span> <span class="kn">import</span> <span class="n">FsspecResultTracker</span>
<span class="kn">from</span> <span class="nn">torchx.specs</span> <span class="kn">import</span> <span class="n">AppDef</span><span class="p">,</span> <span class="n">AppState</span><span class="p">,</span> <span class="n">AppStatus</span><span class="p">,</span> <span class="n">RunConfig</span>


<span class="n">_TORCHX_APP_HANDLE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;torchx_app_handle&quot;</span>
<span class="n">_TORCHX_RUNNER</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;torchx_runner&quot;</span>
<span class="n">_TORCHX_TRACKER_BASE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;torchx_tracker_base&quot;</span>

<span class="c1"># maps torchx AppState to Ax&#39;s TrialStatus equivalent</span>
<span class="n">APP_STATE_TO_TRIAL_STATUS</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AppState</span><span class="p">,</span> <span class="n">TrialStatus</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">UNSUBMITTED</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">CANDIDATE</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">SUBMITTED</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">STAGED</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">PENDING</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">STAGED</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">SUCCEEDED</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">CANCELLED</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">ABANDONED</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">FAILED</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="p">,</span>
    <span class="n">AppState</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span> <span class="n">TrialStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="AppMetric"><a class="viewcode-back" href="../../../../runtime/hpo.html#torchx.runtime.hpo.ax.AppMetric">[docs]</a><span class="k">class</span> <span class="nc">AppMetric</span><span class="p">(</span><span class="n">Metric</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches AppMetric (the observation returned by the trial job/app)</span>
<span class="sd">    via the ``torchx.tracking`` module. Assumes that the app used</span>
<span class="sd">    the tracker in the following manner:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">     tracker = torchx.runtime.tracking.FsspecResultTracker(tracker_base)</span>
<span class="sd">     tracker[str(trial_index)] = {metric_name: value}</span>

<span class="sd">     # -- or --</span>
<span class="sd">     tracker[str(trial_index)] = {&quot;metric_name/mean&quot;: mean_value,</span>
<span class="sd">                                 &quot;metric_name/sem&quot;: sem_value}</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">fetch_trial_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trial</span><span class="p">:</span> <span class="n">BaseTrial</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractDataFrameData</span><span class="p">:</span>
        <span class="n">tracker_base</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">run_metadata</span><span class="p">[</span><span class="n">_TORCHX_TRACKER_BASE</span><span class="p">]</span>
        <span class="n">tracker</span> <span class="o">=</span> <span class="n">FsspecResultTracker</span><span class="p">(</span><span class="n">tracker_base</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">tracker</span><span class="p">[</span><span class="n">trial</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">sem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/mean&quot;</span><span class="p">)</span>
            <span class="n">sem</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/sem&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Observation for `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` not found in tracker at base `</span><span class="si">{</span><span class="n">tracker_base</span><span class="si">}</span><span class="s2">`.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; Ensure that the trial job is writing the results at the same tracker base.&quot;</span>
            <span class="p">)</span>

        <span class="n">df_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;arm_name&quot;</span><span class="p">:</span> <span class="n">none_throws</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">Trial</span><span class="p">,</span> <span class="n">trial</span><span class="p">)</span><span class="o">.</span><span class="n">arm</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;trial_index&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="s2">&quot;metric_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span>
            <span class="s2">&quot;sem&quot;</span><span class="p">:</span> <span class="n">sem</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">Data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">([</span><span class="n">df_dict</span><span class="p">]))</span></div>


<div class="viewcode-block" id="TorchXRunner"><a class="viewcode-back" href="../../../../runtime/hpo.html#torchx.runtime.hpo.ax.TorchXRunner">[docs]</a><span class="k">class</span> <span class="nc">TorchXRunner</span><span class="p">(</span><span class="n">ax_Runner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An implementation of ``ax.core.runner.Runner`` that delegates job submission</span>
<span class="sd">    to the TorchX Runner. This runner is coupled with the torchx component</span>
<span class="sd">    since Ax runners run trials of a single component with different parameters.</span>

<span class="sd">    It is expected that the experiment parameter names and types match</span>
<span class="sd">    EXACTLY with component&#39;s function args. Component function args that are</span>
<span class="sd">    NOT part of the search space can be passed as ``component_const_params``.</span>
<span class="sd">    The following args (provided that the component function declares them</span>
<span class="sd">    in the function signature) as passed automatically:</span>


<span class="sd">    1. ``trial_idx (int)``: current trial&#39;s index</span>
<span class="sd">    2. ``tracker_base (str)``: torchx tracker&#39;s base (typically a URL indicating the base dir of the tracker)</span>

<span class="sd">    Example:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">     def trainer_component(</span>
<span class="sd">        x1: int,</span>
<span class="sd">        x2: float,</span>
<span class="sd">        trial_idx: int,</span>
<span class="sd">        tracker_base: str,</span>
<span class="sd">        x3: float,</span>
<span class="sd">        x4: str) -&gt; spec.AppDef:</span>
<span class="sd">        # ... implementation omitted for brevity ...</span>
<span class="sd">        pass</span>

<span class="sd">    The experiment should be set up as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">     parameters=[</span>
<span class="sd">       {</span>
<span class="sd">         &quot;name&quot;: &quot;x1&quot;,</span>
<span class="sd">         &quot;value_type&quot;: &quot;int&quot;,</span>
<span class="sd">         # ... other options...</span>
<span class="sd">       },</span>
<span class="sd">       {</span>
<span class="sd">         &quot;name&quot;: &quot;x2&quot;,</span>
<span class="sd">         &quot;value_type&quot;: &quot;float&quot;,</span>
<span class="sd">         # ... other options...</span>
<span class="sd">       }</span>
<span class="sd">     ]</span>

<span class="sd">    And the rest of the arguments can be set as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">     TorchXRunner(</span>
<span class="sd">        tracker_base=&quot;s3://foo/bar&quot;,</span>
<span class="sd">        component=trainer_component,</span>
<span class="sd">        # trial_idx and tracker_base args passed automatically</span>
<span class="sd">        # if the function signature declares those args</span>
<span class="sd">        component_const_params={&quot;x3&quot;: 1.2, &quot;x4&quot;: &quot;barbaz&quot;})</span>

<span class="sd">    Running the experiment as set up above results in each trial running:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">     appdef = trainer_component(</span>
<span class="sd">                x1=trial.params[&quot;x1&quot;],</span>
<span class="sd">                x2=trial.params[&quot;x2&quot;],</span>
<span class="sd">                trial_idx=trial.index,</span>
<span class="sd">                tracker_base=&quot;s3://foo/bar&quot;,</span>
<span class="sd">                x3=1.2,</span>
<span class="sd">                x4=&quot;barbaz&quot;)</span>

<span class="sd">     torchx.runner.get_runner().run(appdef, ...)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tracker_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">AppDef</span><span class="p">],</span>
        <span class="n">component_const_params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
        <span class="n">scheduler_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">AppDef</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scheduler</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">scheduler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scheduler_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">]</span> <span class="o">=</span> <span class="n">scheduler_args</span>
        <span class="c1"># need to use the same runner in case it has state</span>
        <span class="c1"># e.g. torchx&#39;s local_scheduler has state hence need to poll status</span>
        <span class="c1"># on the same scheduler instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_torchx_runner</span><span class="p">:</span> <span class="n">Runner</span> <span class="o">=</span> <span class="n">get_runner</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracker_base</span> <span class="o">=</span> <span class="n">tracker_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component_const_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_const_params</span> <span class="ow">or</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trial</span><span class="p">:</span> <span class="n">BaseTrial</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Submits the trial (which maps to an AppDef) as a job</span>
<span class="sd">        onto the scheduler using ``torchx.runner``.</span>

<span class="sd">        ..  note:: only supports `Trial` (not `BatchTrial`).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">Trial</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not supported. Check your experiment setup&quot;</span>
            <span class="p">)</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_component_const_params</span><span class="p">)</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">none_throws</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">arm</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">component_args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="s2">&quot;trial_idx&quot;</span> <span class="ow">in</span> <span class="n">component_args</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;trial_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">index</span>

        <span class="k">if</span> <span class="s2">&quot;tracker_base&quot;</span> <span class="ow">in</span> <span class="n">component_args</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;tracker_base&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracker_base</span>

        <span class="n">appdef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">(</span><span class="o">**</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">app_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_torchx_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">appdef</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scheduler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scheduler_args</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">_TORCHX_APP_HANDLE</span><span class="p">:</span> <span class="n">app_handle</span><span class="p">,</span>
            <span class="n">_TORCHX_RUNNER</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_torchx_runner</span><span class="p">,</span>
            <span class="n">_TORCHX_TRACKER_BASE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracker_base</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="TorchXScheduler"><a class="viewcode-back" href="../../../../runtime/hpo.html#torchx.runtime.hpo.ax.TorchXScheduler">[docs]</a><span class="k">class</span> <span class="nc">TorchXScheduler</span><span class="p">(</span><span class="n">ax_Scheduler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An implementation of an `Ax Scheduler &lt;https://ax.dev/tutorials/scheduler.html&gt;`_</span>
<span class="sd">    that works with Experiments hooked up with the ``TorchXRunner``.</span>

<span class="sd">    This scheduler is not a real scheduler but rather a facade scheduler</span>
<span class="sd">    that delegates to scheduler clients for various remote/local schedulers.</span>
<span class="sd">    For a list of supported schedulers please refer to TorchX</span>
<span class="sd">    `scheduler docs &lt;https://pytorch.org/torchx/latest/schedulers.html&gt;`_.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">poll_trial_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">TrialStatus</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
        <span class="n">trial_statuses</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">TrialStatus</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_trials</span><span class="p">:</span>
            <span class="n">app_handle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">run_metadata</span><span class="p">[</span><span class="n">_TORCHX_APP_HANDLE</span><span class="p">]</span>
            <span class="n">torchx_runner</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">run_metadata</span><span class="p">[</span><span class="n">_TORCHX_RUNNER</span><span class="p">]</span>
            <span class="n">app_status</span><span class="p">:</span> <span class="n">AppStatus</span> <span class="o">=</span> <span class="n">torchx_runner</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">app_handle</span><span class="p">)</span>
            <span class="n">trial_status</span> <span class="o">=</span> <span class="n">APP_STATE_TO_TRIAL_STATUS</span><span class="p">[</span><span class="n">app_status</span><span class="o">.</span><span class="n">state</span><span class="p">]</span>

            <span class="n">indices</span> <span class="o">=</span> <span class="n">trial_statuses</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">trial_status</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
            <span class="n">indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">trial_statuses</span>

    <span class="k">def</span> <span class="nf">poll_available_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used when ``run_trials_in_batches`` option is set.</span>
<span class="sd">        Since this scheduler is a faux scheduler, this method</span>
<span class="sd">        always returns the ``max_parallelism`` of the current</span>
<span class="sd">        step of this scheduler&#39;s ``generation_strategy``.</span>

<span class="sd">        .. note:: The trials (jobs) are simply submitted to the</span>
<span class="sd">                  scheduler in parallel. Typically the trials will be</span>
<span class="sd">                  queued in the scheduler&#39;s job queue (on the server-side)</span>
<span class="sd">                  and executed according to the scheduler&#39;s job priority</span>
<span class="sd">                  and scheduling policies.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generation_strategy</span><span class="o">.</span><span class="n">_curr</span><span class="o">.</span><span class="n">max_parallelism</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">not_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generation_strategy</span><span class="o">.</span><span class="n">_curr</span><span class="o">.</span><span class="n">max_parallelism</span><span class="p">)</span>
        <span class="p">)</span></div>
</pre></div>

     </article>
     
    </div>
    <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, TorchX Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

  </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
         <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
         <script src="../../../../_static/jquery.js"></script>
         <script src="../../../../_static/underscore.js"></script>
         <script src="../../../../_static/doctools.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
         <script src="../../../../_static/katex_autorenderer.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="../../../../_static/js/torchx.js"></script>
     

  

  <script type="text/javascript" src="../../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Stay Connected</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
            <a href="https://www.youtube.com/pytorch" target="_blank" class="youtube"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebookâ€™s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
            </li>

            <li>
              <a href="https://pytorch.org/text/stable/index.html">torchtext</a>
            </li>

            <li>
              <a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
            </li>

            <li>
              <a href="https://pytorch.org/elastic/">TorchElastic</a>
            </li>

            <li>
              <a href="https://pytorch.org/serve/">TorchServe</a>
            </li>

            <li>
              <a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/resources">Developer Resources</a>
            </li>

            <li>
              <a href="https://pytorch.org/features">About</a>
            </li>

            <li>
              <a href="https://pytorch.org/hub">Models (Beta)</a>
            </li>

            <li>
              <a href="https://pytorch.org/#community-module">Community</a>
            </li>

            <li>
              <a href="https://discuss.pytorch.org/">Forums</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>